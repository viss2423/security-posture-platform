# Copy to .env and adjust. Required for docker compose.

POSTGRES_DB=secplat
POSTGRES_USER=secplat
POSTGRES_PASSWORD=secplat
POSTGRES_PORT=5433

OPENSEARCH_HEAP=512m
OPENSEARCH_INITIAL_ADMIN_PASSWORD=admin
OPENSEARCH_PORT=9200

# Phase 1: Redis for job queue (default in compose: redis://redis:6379/0). Unset to disable queue; worker falls back to DB poll.
# REDIS_URL=redis://redis:6379/0

GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
GRAFANA_PORT=3001

JUICESHOP_PORT=3002
API_PORT=8000
WEB_PORT=8082

ENV=dev
API_SECRET_KEY=change-me-in-production

# Auth: in prod use ADMIN_PASSWORD_HASH (bcrypt) or a strong ADMIN_PASSWORD; admin/admin is rejected when ENV=prod
ADMIN_USERNAME=admin
ADMIN_PASSWORD=admin
# ADMIN_PASSWORD_HASH=  # generate: python -c "from passlib.context import CryptContext; print(CryptContext(schemes=['bcrypt']).hash('your-secure-password'))"
# JWT_ACCESS_TOKEN_EXPIRE_MINUTES=1440

# Ingestion: example-com probes this URL (independent of juice-shop). Use https://example.com or another endpoint.
EXAMPLE_COM_URL=https://example.com

# Posture rules (align with ingestion/Grafana)
STALE_THRESHOLD_SECONDS=300
EXPECTED_CHECK_INTERVAL_SECONDS=60
LATENCY_SLO_MS=200

# Optional: Slack webhook for alert action (POST /posture/alert/send notifies when assets are down)
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
# Slack interactive (B.4): signing secret to verify button clicks. Set Interactivity URL to https://your-api/integrations/slack/interactions
# SLACK_SIGNING_SECRET=

# WhatsApp (Twilio): alert when assets are down. Use instead of or with Slack.
# Get SID + token from Twilio Console; use WhatsApp Sandbox or approved number for TWILIO_WHATSAPP_FROM.
# TWILIO_ACCOUNT_SID=
# TWILIO_AUTH_TOKEN=
# TWILIO_WHATSAPP_FROM=whatsapp:+14155238886
# WHATSAPP_ALERT_TO=whatsapp:+1234567890

# Jira (B.4): create ticket from incident. Atlassian API token: https://id.atlassian.com/manage-profile/security/api-tokens
# JIRA_BASE_URL=https://your.atlassian.net
# JIRA_EMAIL=you@example.com
# JIRA_API_TOKEN=
# JIRA_PROJECT_KEY=SEC

# Retention (POST /retention/apply): delete events older than N days; keep last N report snapshots
# EVENTS_RETENTION_DAYS=90
# SNAPSHOTS_RETENTION_KEEP=500

# Logging
# LOG_LEVEL=INFO

# Rate limiting (in-memory): login attempts per IP per minute; retention apply per IP per hour
# RATE_LIMIT_LOGIN_PER_MINUTE=5
# RATE_LIMIT_RETENTION_PER_HOUR=10

# OIDC / SSO (optional). When set, login page shows "Sign in with SSO". Users must exist in users table (username = IdP preferred_username or email prefix).
# OIDC_ISSUER_URL=https://login.microsoftonline.com/YOUR_TENANT_ID/v2.0
# OIDC_CLIENT_ID=
# OIDC_CLIENT_SECRET=
# OIDC_REDIRECT_URI=http://localhost:8000/auth/oidc/callback
# OIDC_SCOPES=openid profile email
# FRONTEND_URL=http://localhost:3000

# Frontend (Next.js) â€“ optional
FRONTEND_PORT=3000
NEXT_PUBLIC_GRAFANA_URL=http://localhost:3001
# Optional: link "View in OpenSearch" on asset evidence (e.g. OpenSearch Dashboards)
# NEXT_PUBLIC_OPENSEARCH_DASHBOARDS_URL=http://localhost:5601
MAX_SCAN_DURATION_SECONDS=900
MAX_REQUESTS_PER_SECOND=10
BLOCK_PRIVATE_IPS=true
REQUIRE_DOMAIN_VERIFICATION=true

# OpenAI / Codex integration
# Set your OpenAI API key here (keep secret). Optionally override model.
# Example: OPENAI_API_KEY=sk-...
OPENAI_API_KEY=
# Model name for completions (codex-capable models like `code-davinci-002`)
OPENAI_MODEL=code-davinci-002
