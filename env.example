# Copy to .env and adjust. Required for docker compose.

POSTGRES_DB=secplat
POSTGRES_USER=secplat
POSTGRES_PASSWORD=secplat
POSTGRES_PORT=5433

OPENSEARCH_HEAP=512m
OPENSEARCH_INITIAL_ADMIN_PASSWORD=admin
OPENSEARCH_PORT=9200

GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
GRAFANA_PORT=3001

JUICESHOP_PORT=3000
API_PORT=8000
WEB_PORT=8082

ENV=dev
API_SECRET_KEY=change-me-in-production

# Auth: in prod use ADMIN_PASSWORD_HASH (bcrypt) or a strong ADMIN_PASSWORD; admin/admin is rejected when ENV=prod
ADMIN_USERNAME=admin
ADMIN_PASSWORD=admin
# ADMIN_PASSWORD_HASH=  # generate: python -c "from passlib.context import CryptContext; print(CryptContext(schemes=['bcrypt']).hash('your-secure-password'))"
# JWT_ACCESS_TOKEN_EXPIRE_MINUTES=1440

# Ingestion: example-com probes this URL (independent of juice-shop). Use https://example.com or another endpoint.
EXAMPLE_COM_URL=https://example.com

# Posture rules (align with ingestion/Grafana)
STALE_THRESHOLD_SECONDS=300
EXPECTED_CHECK_INTERVAL_SECONDS=60
LATENCY_SLO_MS=200

# Optional: Slack webhook for alert action (POST /posture/alert/send notifies when assets are down)
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Retention (POST /retention/apply): delete events older than N days; keep last N report snapshots
# EVENTS_RETENTION_DAYS=90
# SNAPSHOTS_RETENTION_KEEP=500

# Logging
# LOG_LEVEL=INFO

# Rate limiting (in-memory): login attempts per IP per minute; retention apply per IP per hour
# RATE_LIMIT_LOGIN_PER_MINUTE=5
# RATE_LIMIT_RETENTION_PER_HOUR=10

# Frontend (Next.js) â€“ optional
FRONTEND_PORT=3002
NEXT_PUBLIC_GRAFANA_URL=http://localhost:3001
# Optional: link "View in OpenSearch" on asset evidence (e.g. OpenSearch Dashboards)
# NEXT_PUBLIC_OPENSEARCH_DASHBOARDS_URL=http://localhost:5601
MAX_SCAN_DURATION_SECONDS=900
MAX_REQUESTS_PER_SECOND=10
BLOCK_PRIVATE_IPS=true
REQUIRE_DOMAIN_VERIFICATION=true
